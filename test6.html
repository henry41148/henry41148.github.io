<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Polished Portfolio Carousel — Henry</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  :root{
    --bg-a:#0b0b14;
    --bg-b:#141426;
    --accent-a:#5561f2;
    --accent-b:#66e0d0;
    --glass: rgba(255,255,255,0.04);
    --card-w:360px;
    --card-h:480px;
  }

  *{box-sizing:border-box;margin:0;padding:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial}
  html,body{height:100%}
  body{
    min-height:100vh;background:linear-gradient(135deg,var(--bg-a),var(--bg-b));
    color:#fff;display:flex;align-items:center;justify-content:center;padding:2rem;overflow:hidden;
  }

  .container{width:100%;max-width:1400px;margin:auto;position:relative;z-index:2}

  header{display:flex;align-items:center;justify-content:space-between;gap:1rem;margin-bottom:1rem}
  .branding{display:flex;flex-direction:column}
  h1{font-size:1.6rem;font-weight:800;background:linear-gradient(90deg,var(--accent-a),var(--accent-b));-webkit-background-clip:text;background-clip:text;color:transparent}
  p.subtitle{color:rgba(255,255,255,0.78);font-size:0.95rem;max-width:720px}

  .controls{display:flex;gap:0.6rem;align-items:center}
  .cta{background:linear-gradient(90deg,var(--accent-a),var(--accent-b));border:none;padding:0.5rem 0.85rem;border-radius:999px;color:#fff;font-weight:700;cursor:pointer;box-shadow:0 10px 40px rgba(86,89,236,0.12)}

  /* Background ambience (parallax) */
  .bg{
    position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden;
  }
  .orb{
    position:absolute;border-radius:50%;filter:blur(60px);opacity:0.7;
    background:radial-gradient(circle at 30% 30%, rgba(86,89,236,0.14), rgba(102,224,208,0.06) 40%, transparent 60%);
    transform:translate3d(0,0,0);
  }
  .orb.o1{width:460px;height:460px;left:3%;top:6%}
  .orb.o2{width:680px;height:680px;right:-12%;bottom:-12%}

  .view-toggle{display:flex;gap:0.5rem;justify-content:center;margin:0.8rem 0 1.2rem}
  .toggle-btn{padding:0.5rem 0.8rem;border-radius:999px;background:var(--glass);border:1px solid rgba(255,255,255,0.03);cursor:pointer;color:#fff;font-weight:700}
  .toggle-btn.active{background:linear-gradient(90deg,var(--accent-a),var(--accent-b));box-shadow:0 10px 30px rgba(86,89,236,0.12)}

  /* Carousel */
  .carousel-area{position:relative;height:520px;perspective:1400px;display:block;overflow:visible}
  .carousel{position:absolute;inset:0;margin:auto;transform-style:preserve-3d;transition:transform 880ms cubic-bezier(.22,1,.36,1);will-change:transform}

  /* Spotlight behind center card */
  .spotlight{
    position:absolute;left:50%;top:52%;transform:translateX(-50%);width:680px;height:420px;border-radius:50%;
    background:radial-gradient(closest-side, rgba(100,110,255,0.10), rgba(80,80,120,0.02) 45%, transparent 60%);
    pointer-events:none;filter:blur(14px);z-index:0;
  }

  .project-card{
    position:absolute;width:var(--card-w);height:var(--card-h);left:50%;top:50%;
    border-radius:14px;overflow:hidden;cursor:pointer;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.12));
    box-shadow: 0 30px 80px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
    transition: transform 600ms cubic-bezier(.22,1,.36,1), opacity 400ms linear, filter 400ms;
    transform-origin:center center;backface-visibility:hidden; -webkit-backface-visibility:hidden;
    display:flex;flex-direction:column;z-index:10;outline:none;
  }

  .card-badge{
    position:absolute;left:14px;top:14px;background:rgba(255,255,255,0.05);padding:6px 10px;border-radius:10px;font-weight:700;font-size:0.85rem;color:var(--accent-b);
    border:1px solid rgba(255,255,255,0.03);
  }

  .project-image{height:220px;overflow:hidden;position:relative}
  .project-image img{width:100%;height:100%;object-fit:cover;display:block;transition:transform 900ms cubic-bezier(.22,1,.36,1)}
  .project-content{padding:1.4rem;display:flex;flex-direction:column;gap:0.6rem;flex:1}
  .project-title{font-size:1.22rem;font-weight:800}
  .project-description{color:rgba(255,255,255,0.86);font-size:0.95rem;line-height:1.42;flex:1}
  .tech-row{display:flex;gap:0.5rem;flex-wrap:wrap;margin-top:0.6rem}
  .tech{padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.03);font-weight:700;font-size:0.82rem;color:var(--accent-b);border:1px solid rgba(255,255,255,0.03)}

  .project-links{display:flex;gap:0.6rem;margin-top:0.6rem}
  .project-link{background:rgba(255,255,255,0.03);padding:0.5rem 0.8rem;border-radius:10px;text-decoration:none;color:#fff;font-weight:700}

  /* navigation controls */
  .navs{display:flex;justify-content:center;gap:0.8rem;margin-top:1rem}
  .nav-btn{width:52px;height:52px;border-radius:50%;background:rgba(255,255,255,0.03);border:none;color:#fff;font-size:1.05rem;display:inline-flex;align-items:center;justify-content:center;cursor:pointer}
  .nav-btn:hover{transform:scale(1.06)}

  .indicators{display:flex;justify-content:center;gap:0.6rem;margin-top:1rem}
  .dot{width:12px;height:12px;border-radius:50%;background:rgba(255,255,255,0.12);cursor:pointer}
  .dot.active{background:linear-gradient(90deg,var(--accent-a),var(--accent-b));transform:scale(1.35);box-shadow:0 8px 28px rgba(86,89,236,0.15)}

  /* modal */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,0.75);display:flex;align-items:center;justify-content:center;opacity:0;visibility:hidden;transition:all 220ms}
  .modal.active{opacity:1;visibility:visible}
  .modal-card{width:92%;max-width:920px;background:linear-gradient(180deg,#0f1020,#121226);padding:1.2rem;border-radius:12px;max-height:88vh;overflow:auto;position:relative}
  .close-x{position:absolute;right:14px;top:14px;background:none;border:none;color:#fff;font-size:1.25rem}

  /* grid fallback */
  .grid{display:none;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1rem;margin-top:1rem}

  /* responsiveness */
  @media (max-width:1100px){:root{--card-w:320px;--card-h:440px}}
  @media (max-width:780px){
    .carousel-area{height:480px}
    header{flex-direction:column;align-items:flex-start}
    .bg{display:none}
  }
  @media (max-width:480px){
    :root{--card-w:280px;--card-h:420px}
    h1{font-size:1.1rem}
  }

  @media (prefers-reduced-motion: reduce){
    .carousel,.project-card,.project-image img{transition:none !important}
  }
</style>
</head>
<body>
  <div class="bg" aria-hidden="true">
    <div class="orb o1"></div>
    <div class="orb o2"></div>
  </div>

  <div class="container">
    <header>
      <div class="branding">
        <h1>Project Portfolio</h1>
        <p class="subtitle">Sleek, professional, and creative — click a side card to focus it; click the center card to open details.</p>
      </div>
      <div class="controls">
        <button class="cta" onclick="location.href='#'"><i class="fas fa-file-download"></i>&nbsp;Download CV</button>
      </div>
    </header>

    <div class="view-toggle" role="tablist" aria-hidden="true">
      <button id="carouselTab" class="toggle-btn active">3D Carousel</button>
      <button id="gridTab" class="toggle-btn">Grid</button>
    </div>

    <div class="carousel-area" id="carouselArea" aria-label="Project carousel">
      <div class="spotlight" aria-hidden="true"></div>
      <div class="carousel" id="carousel" role="list"></div>

      <div class="navs">
        <button class="nav-btn" id="prevBtn" aria-label="Previous"><i class="fas fa-chevron-left"></i></button>
        <button class="nav-btn" id="nextBtn" aria-label="Next"><i class="fas fa-chevron-right"></i></button>
      </div>

      <div class="indicators" id="dots" aria-hidden="true"></div>
    </div>

    <div class="grid" id="grid" aria-hidden="true"></div>
  </div>

  <!-- Modal -->
  <div class="modal" id="modal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-card" id="modalCard">
      <button class="close-x" id="closeModal" aria-label="Close"><i class="fas fa-times"></i></button>
      <div id="modalContent"></div>
    </div>
  </div>

<script>
/* ================= DATA ================= */
const projects = [
  { title:"Neural Network Visualization", description:"Interactive 3D visualization of neural networks with live training metrics.", image:"https://images.unsplash.com/photo-1589254066210-9a5c5b0a5c8a?auto=format&fit=crop&w=1200&q=80", technologies:["Three.js","TensorFlow.js","WebGL","React"], live:"#", code:"#", details:"Visualize layers, activations, and training. Includes adjustable hyperparameters and real-time graphs." },
  { title:"Quantum Computing Simulator", description:"Browser quantum circuit builder with state visualizations.", image:"https://images.unsplash.com/photo-1635070041078-e363dbe005cb?auto=format&fit=crop&w=1200&q=80", technologies:["JavaScript","QuantumJS","SVG","Web Workers"], live:"#", code:"#", details:"Drag-drop gates, visualized probabilities, and measurement results." },
  { title:"AR Product Preview", description:"AR e-commerce viewer using WebXR for in-situ previews.", image:"https://images.unsplash.com/photo-1626379953821-29c5c7750ab9?auto=format&fit=crop&w=1200&q=80", technologies:["WebXR","A-Frame","Three.js"], live:"#", code:"#", details:"Place, scale, rotate, and customize product materials in the camera view." },
  { title:"Real-time Collaboration", description:"Collaborative IDE with real-time editing and video chat.", image:"https://images.unsplash.com/photo-1552664730-d307ca884978?auto=format&fit=crop&w=1200&q=80", technologies:["WebSockets","Node.js","React","WebRTC"], live:"#", code:"#", details:"Shared editing, terminal sharing, and integrated WebRTC conferencing." },
  { title:"Generative Art Engine", description:"Procedural art generation with deterministic seeds and export.", image:"https://images.unsplash.com/photo-1547658719-da2b51169166?auto=format&fit=crop&w=1200&q=80", technologies:["Canvas API","GLSL","p5.js"], live:"#", code:"#", details:"Multiple generators, parameter presets, and high-resolution export." },
  { title:"Data Visualization Dashboard", description:"Interactive dashboard with D3 visualizations and streaming data.", image:"https://images.unsplash.com/photo-1555949963-aa79dcee981c?auto=format&fit=crop&w=1200&q=80", technologies:["React","D3.js","WebSocket","IndexedDB"], live:"#", code:"#", details:"Complex filtering, custom charts, and performance optimizations for large datasets." }
];

/* ================= DOM ================= */
const carousel = document.getElementById('carousel');
const dotsContainer = document.getElementById('dots');
const gridEl = document.getElementById('grid');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const modal = document.getElementById('modal');
const modalContent = document.getElementById('modalContent');
const closeModalBtn = document.getElementById('closeModal');
const carouselArea = document.getElementById('carouselArea');
const carouselTab = document.getElementById('carouselTab');
const gridTab = document.getElementById('gridTab');

let cards = [];
let currentIndex = 0;          // integer index of focused card
let angle = 0;
let radius = 600;
let autoInterval = null;
let isGrid = false;

/* ================= RENDER ================= */
function render() {
  carousel.innerHTML = '';
  dotsContainer.innerHTML = '';
  gridEl.innerHTML = '';

  projects.forEach((p, i) => {
    // card
    const card = document.createElement('article');
    card.className = 'project-card';
    card.setAttribute('data-index', i);
    card.setAttribute('tabindex', '0');
    card.innerHTML = `
      <div class="card-badge">Case Study</div>
      <div class="project-image"><img loading="lazy" src="${p.image}" alt="${p.title}"></div>
      <div class="project-content">
        <h3 class="project-title">${p.title}</h3>
        <p class="project-description">${p.description}</p>
        <div class="tech-row">${p.technologies.map(t=>`<span class="tech">${t}</span>`).join('')}</div>
        <div class="project-links">
          <a class="project-link" href="${p.live}" tabindex="-1"><i class="fas fa-external-link-alt"></i>&nbsp;Live</a>
          <a class="project-link" href="${p.code}" tabindex="-1"><i class="fab fa-github"></i>&nbsp;Code</a>
        </div>
      </div>
    `;
    // click behavior:
    // - if clicked card is currently focused, open modal (click-to-show)
    // - otherwise, set it as focused (click-to-change)
    card.addEventListener('click', (ev) => {
      const idx = Number(card.dataset.index);
      if (idx === currentIndex) openModal(idx);
      else { currentIndex = idx; position(); restartAuto(); }
    });
    // keyboard accessibility
    card.addEventListener('keydown', (e) => {
      const idx = Number(card.dataset.index);
      if (e.key === 'Enter') {
        if (idx === currentIndex) openModal(idx);
        else { currentIndex = idx; position(); restartAuto(); }
      }
    });

    carousel.appendChild(card);

    // dot
    const dot = document.createElement('div');
    dot.className = 'dot';
    dot.addEventListener('click', (e) => {
      e.stopPropagation();
      currentIndex = i;
      position();
      restartAuto();
    });
    dotsContainer.appendChild(dot);

    // grid card
    const g = document.createElement('div');
    g.className = 'grid-item';
    g.style.borderRadius = '12px';
    g.style.overflow = 'hidden';
    g.style.background = 'linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.08))';
    g.style.cursor = 'pointer';
    g.innerHTML = `<div style="height:160px;overflow:hidden"><img loading="lazy" src="${p.image}" style="width:100%;height:100%;object-fit:cover"></div>
      <div style="padding:12px"><h4 style="margin:0 0 6px">${p.title}</h4><p style="color:rgba(255,255,255,0.85);margin:0">${p.description}</p></div>`;
    g.addEventListener('click', () => { openModal(i); });
    gridEl.appendChild(g);
  });

  cards = Array.from(document.querySelectorAll('.project-card'));
  angle = 360 / projects.length;

  // after cards exist, compute radius and place
  position();
  attachCursorTilt();
}

/* ================ POSITIONING ================ */
function computeRadius() {
  if (!cards[0]) return 600;
  const cw = cards[0].offsetWidth || parseInt(getComputedStyle(document.documentElement).getPropertyValue('--card-w')) || 360;
  // radius formula to place cards without overlap
  const computed = Math.round((cw / (2 * Math.tan(Math.PI / projects.length))));
  const maxR = Math.max(carouselArea.offsetWidth * 0.9, 420);
  return Math.min(Math.max(computed, 260), maxR);
}

function position() {
  if (!cards || cards.length === 0) return;
  radius = computeRadius();
  // rotate carousel so currentIndex is front
  // we rotate carousel by -currentIndex * angle (so card at index gets to front)
  const rotation = -currentIndex * angle;
  carousel.style.transform = `translateZ(-${radius}px) rotateY(${rotation}deg)`;

  // set transforms for each card
  cards.forEach((card, i) => {
    const rot = i * angle;
    // compute shortest circular distance for depth cues
    let diff = Math.abs(i - currentIndex);
    // wrap-around
    diff = Math.min(diff, projects.length - diff);
    const depthFactor = Math.max(0, 1 - diff / (projects.length / 2));
    const scale = 0.92 + 0.18 * depthFactor; // ~[0.92..1.1]
    const opacity = 0.45 + 0.55 * depthFactor; // ~[0.45..1]
    const zIndex = Math.round(1000 - diff * 10);

    // Place on cylinder and center with translate(-50%, -50%)
    card.style.zIndex = zIndex;
    card.style.opacity = opacity;
    card.style.transform = `translateX(-50%) translateY(-50%) rotateY(${rot}deg) translateZ(${radius}px) scale(${scale})`;

    // subtle image zoom for focused card
    const img = card.querySelector('.project-image img');
    if (img) img.style.transform = (i === currentIndex) ? 'scale(1.06)' : 'scale(1)';
  });

  // update dots
  Array.from(dotsContainer.children).forEach((d, idx) => d.classList.toggle('active', idx === currentIndex));
}

/* ================ interactions ================ */

// clicking center card opens modal handled above in render()

function openModal(i) {
  const p = projects[i];
  modalContent.innerHTML = `
    <div style="display:flex;flex-direction:column;gap:1rem">
      <div style="height:320px;overflow:hidden;border-radius:8px"><img loading="lazy" src="${p.image}" alt="${p.title}" style="width:100%;height:100%;object-fit:cover"></div>
      <h2 style="margin:0">${p.title}</h2>
      <p style="color:rgba(255,255,255,0.9);margin:0">${p.description}</p>
      <p style="color:rgba(255,255,255,0.82)">${p.details}</p>
      <div style="display:flex;gap:0.5rem;flex-wrap:wrap">${p.technologies.map(t=>`<span style="background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:999px">${t}</span>`).join('')}</div>
      <div style="display:flex;gap:0.6rem;margin-top:0.6rem">
        <a class="project-link" href="${p.live}" target="_blank" rel="noopener"><i class="fas fa-external-link-alt"></i>&nbsp;Live Demo</a>
        <a class="project-link" href="${p.code}" target="_blank" rel="noopener"><i class="fab fa-github"></i>&nbsp;Source</a>
      </div>
    </div>
  `;
  modal.classList.add('active');
  modal.setAttribute('aria-hidden','false');
  document.body.style.overflow = 'hidden';
  stopAuto();
}
function closeModal() {
  modal.classList.remove('active');
  modal.setAttribute('aria-hidden','true');
  document.body.style.overflow = 'auto';
  startAuto();
}

closeModalBtn.addEventListener('click', closeModal);
modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });

/* keyboard & nav */
document.addEventListener('keydown', (e) => {
  if (e.key === 'ArrowLeft' && !isGrid) { currentIndex = (currentIndex - 1 + projects.length) % projects.length; position(); restartAuto(); }
  if (e.key === 'ArrowRight' && !isGrid) { currentIndex = (currentIndex + 1) % projects.length; position(); restartAuto(); }
  if (e.key === 'Escape') closeModal();
});

prevBtn.addEventListener('click', () => { currentIndex = (currentIndex - 1 + projects.length) % projects.length; position(); restartAuto(); });
nextBtn.addEventListener('click', () => { currentIndex = (currentIndex + 1) % projects.length; position(); restartAuto(); });

/* pointer tilt effect for the focused card */
function attachCursorTilt() {
  // remove previous listeners
  cards.forEach(c => {
    c.onpointermove = null;
    c.onpointerleave = null;
  });

  cards.forEach((card, i) => {
    card.onpointermove = (ev) => {
      // apply tilt only visually — but preserve base cylinder transform
      const rect = card.getBoundingClientRect();
      const cx = rect.left + rect.width / 2;
      const cy = rect.top + rect.height / 2;
      const dx = ev.clientX - cx;
      const dy = ev.clientY - cy;
      const px = dx / (rect.width / 2);
      const py = dy / (rect.height / 2);
      const tiltY = px * 10; // left/right
      const tiltX = -py * 8; // up/down

      // get base transform before tilt (we stored in style.transform)
      // We'll append rotateX/rotateY to simulate tilt
      const base = card.style.transform.split(' rotateX(')[0];
      card.style.transform = `${base} rotateX(${tiltX}deg) rotateY(${tiltY}deg)`;
    };
    card.onpointerleave = () => { position(); };
  });
}

/* ================ Auto-rotation ================ */
function startAuto() {
  stopAuto();
  autoInterval = setInterval(() => {
    currentIndex = (currentIndex + 1) % projects.length;
    position();
  }, 4200);
}
function stopAuto() { if (autoInterval) { clearInterval(autoInterval); autoInterval = null; } }
function restartAuto() { stopAuto(); startAuto(); }

// pause when pointer in carousel area
carouselArea.addEventListener('pointerenter', stopAuto);
carouselArea.addEventListener('pointerleave', startAuto);

/* toggle grid/carousel */
carouselTab.addEventListener('click', () => {
  if (isGrid) {
    isGrid = false;
    carouselTab.classList.add('active'); gridTab.classList.remove('active');
    document.getElementById('carousel').parentElement.style.display = 'block';
    gridEl.style.display = 'none';
    position();
    startAuto();
  }
});
gridTab.addEventListener('click', () => {
  if (!isGrid) {
    isGrid = true;
    gridTab.classList.add('active'); carouselTab.classList.remove('active');
    document.getElementById('carousel').parentElement.style.display = 'block'; // still keep layout
    // show grid
    gridEl.style.display = 'grid';
    document.getElementById('carousel').style.display = 'none';
    stopAuto();
  }
});

/* touch swipe for carousel */
let sx = 0;
carousel.addEventListener('touchstart', e => sx = e.changedTouches[0].clientX);
carousel.addEventListener('touchend', e => {
  const ex = e.changedTouches[0].clientX;
  if (sx - ex > 40) { currentIndex = (currentIndex + 1) % projects.length; position(); restartAuto(); }
  else if (ex - sx > 40) { currentIndex = (currentIndex - 1 + projects.length) % projects.length; position(); restartAuto(); }
});

/* recalc on resize */
let rt;
window.addEventListener('resize', () => { clearTimeout(rt); rt = setTimeout(() => { position(); }, 120); });

/* init */
window.addEventListener('load', () => { render(); startAuto(); });
</script>
</body>
</html>
